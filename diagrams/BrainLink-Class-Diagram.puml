@startuml
' --- Settings ---
skinparam classAttributeIconSize 0
skinparam linetype ortho
skinparam roundcorner 10
hide empty members

' --- Abstract User Class ---
abstract class User {
  # userId: UUID
  # username: String
  # email: String
  # passwordHash: String
  + login()
  + logout()
  + updateProfileDetails()
}

' --- Concrete User Roles ---
class Learner {
  + findMatch()
  + scheduleStudySession()
  + createFlashcardDeck()
  + takeQuizz()
  + viewCalendar()
  + viewStats()
  + createNote()
  + reportUser(reported: Learner)
  + blockUser(blocked: Learner)
}

class Admin {
  + manageUser(user: User)
  + viewSystemStats()
  + reviewReport(report: Report)
  + banUser(user: User)
}

' --- User Profile & Content ---
class Profile {
  - learningStyle: String
  - availability: List<TimeSlot>
  - skillsToOffer: List<String>
  - skillsToLearn: List<String>
}

class Subject {
  - subjectId: UUID
  - name: String
  - description: String
}

' --- Learning Content ---
abstract class LearningContent {
  # contentId: UUID
  # title: String
}

class FlashcardDeck {
  + study()
}

class Flashcard {
  - front: String
  - back: String
}

class Quizz {
  + start()
}

class Question {
  - text: String
  - options: List<String>
  - correctAnswer: String
}

class Documentation {
  - content: String
}

' --- Scheduling & Interaction ---
class StudySession {
  - sessionId: UUID
  - startTime: DateTime
  - endTime: DateTime
  - isVirtual: boolean
  - status: SessionStatus
  + startSession()
  + endSession()
}

class SessionInvite {
  - status: InviteStatus
  + accept()
  + reject()
}

class SessionSummary {
  - summaryId: UUID
  - generatedContent: String
}

class SharedNote {
  - noteId: UUID
  - content: String
}

' --- Safety & Feedback ---
class Report {
  - reportId: UUID
  - reason: String
  - timestamp: DateTime
}

class Feedback {
  - rating: int
  - comment: String
}

' --- AI Service (as a service, not a user) ---
class AIService {
  + generateFlashcards(subject: Subject): FlashcardDeck
  + generateQuizz(subject: Subject): Quizz
  + generateDocumentation(subject: Subject): Documentation
  + validateSubject(text: String): boolean
  + generateSessionSummary(session: StudySession): SessionSummary
  + calculateCompatibility(p1: Profile, p2: Profile): Score
}

' --- Relationships ---

' Inheritance
User <|-- Learner
User <|-- Admin

' User & Profile (Composition)
Learner "1" *-- "1" Profile

' Learner & Subjects (Many-to-Many)
Learner "<em>" -- "</em>" Subject : "studies"

' Profile & Subjects (Aggregation)
Profile "1" o-- "0..<em>" Subject : "interests"

' Learner & Learning Content (Associations)
Learner "1" -- "0..</em>" LearningContent : "created by"
LearningContent <|-- FlashcardDeck
LearningContent <|-- Quizz
LearningContent <|-- Documentation

' Content Composition
FlashcardDeck "1" *-- "1..<em>" Flashcard
Quizz "1" *-- "1..</em>" Question

' Subject & Content (Aggregation)
Subject "1" o-- "0..*" LearningContent

' Study Session Relationships
Learner "1" -- "0..*" StudySession : "organizes"
StudySession "1" *-- "1..*" SessionInvite : "sends"
SessionInvite "1" --> "1" Learner : "to"
StudySession "1" o-- "0..*" SharedNote
StudySession "1" o-- "0..1" SessionSummary

' Safety & Feedback (Association Classes & Links)
(Learner, StudySession) .. Feedback
Learner "1" -- "0..<em>" Report : "files"
Report "1" -- "1" Learner : "against"
Admin "1" ..> "0..</em>" Report : "reviews"
Learner "<em>" --> "</em>" Learner : "blocks"

' Peer-to-Peer Request (Association Class)
(Learner, Learner) .. PeerConnection
class PeerConnection {
  - status: ConnectionStatus
  - timestamp: DateTime
}

' AI Service Dependencies (Usage)
AIService ..> Subject
AIService ..> StudySession
AIService ..> Profile
Learner ..> AIService

@enduml